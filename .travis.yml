language: crystal

addons:
  apt:
    packages:
      - python-scipy
      - python-yaml

git:
  submodules: false

env:
  - TASK=bench LANG=crystal
  - TASK=style LANG=crystal
  - TASK=bench LANG=java
  - TASK=style LANG=java
  - TASK=bench LANG=js
  - TASK=style LANG=js
  - TASK=bench LANG=ruby
  - TASK=style LANG=ruby
  - TASK=bench LANG=som
  - TASK=style LANG=som
  - TASK=bench LANG=somns
  - TASK=style LANG=somns

install:
  - if [ "$TASK" = "bench" ]; then pip install --user ReBench; fi

script:
  - if [ "$TASK" = "bench" ]; then implementations/build-$LANG.sh && rebench -d test.conf test-java; fi
  - if [ "$TASK" = "style" ]; then implementations/build-$LANG.sh style; fi
